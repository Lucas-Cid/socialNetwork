<!DOCTYPE HTML>
<html>
	<head>
		<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<meta charset="UTF-8">

	</head>
	<body>
		<div class="dashboard">
			<div class="title">
				<strong>SITE NAME</strong>
			</div>
			<div class="topBar">
					<% if user_signed_in? %>
					    Logged in as <strong><%= current_user.email %></strong>.
					    <%= link_to 'Edit profile', edit_user_registration_path, :class => 'navbar-link' %> |
					    <%= link_to "Logout", destroy_user_session_path, method: :delete, :class => 'navbar-link'  %>
					<% else %>
							<%= link_to "Sign up", new_user_registration_path, :class => 'navbar-link'  %> |
					    <%= link_to "Login", new_user_session_path, :class => 'navbar-link'  %>
					<% end %>
			</div>

			<div class="timeline">
				<div class="left">
					<div id="postCreation" class="card gedf-card">
						<%= form_with url: "/posts", authenticity_token: false do |f|%>
							<div class="card-header">
							</div>
							<div class="card-body">
								<textarea class="text" name="content" autofocus placeholder="Tell me a secret"></textarea>

								<input id="user_information" name="user_id" type="hidden", value="<%= current_user.id %>" />
							</div>

							<div class="actions">
							    <%= f.submit "Send", :class => 'btn btn-primay' %>
							</div>

						<% end %>
					</div>
				</div>
				<div class="middle">
					<div class="allPosts">
						<tbody>
						    <% Post.all.order(:id).reverse.first(10).each do |post| %>

						    	<div class="post">

							    	<div class="card">

							    		<div class="card-header">
									        <%= User.find(post.user_id).name %>
									    </div>

									    <div class="card-body">
									        <%= post.content %>
									    </div>

									 	<div class="card-footer">

									        <%= form_with url: "/reactions", authenticity_token: false do |f|%>
										       	<input id="user_id" name="user_id" type="hidden", value="<%= current_user.id %>" />
										       	<input id="owner_id" name="owner_id" type="hidden", value="<%= post.id %>" />
										       	<input id="owner_type" name="owner_type" type="hidden", value="Post" />

										        <div class="actions">
										   		 	<%= button_tag( :class => "icon-thumb-up", :value => "type1" , :name => 'reactionType') do %>
													<% end %>
										   		 		<%= post.reactionType1 %>
										 	    </div>

										 	    <div class="actions">
											   		 <%= button_tag( :class => "icon-shocked2", :value => "type2" , :name => 'reactionType') do %>
											   		 <% end %>
										   		 <%= post.reactionType2 %>
										 	    </div>

										 	    <div class="actions">
											   		 <%= button_tag( :class => "icon-angry2", :value => "type3" , :name => 'reactionType') do %>
											   		 <% end %>
											   		 <%= post.reactionType3 %>
										 	    </div>

										 	    <div class="actions">
											   		 <%= button_tag( :class => "icon-crying2", :value => "type4" , :name => 'reactionType') do %>
											   		 <% end %>
											   		 <%= post.reactionType4 %>
										 			</div>

										 		<div class="actions">
											   		 <%= button_tag( :class => "icon-thumbs-down1", :value => "dislike" , :name => 'reactionType') do %>
											   		 <% end %>
											   		 <%= post.dislikes %>
										 		</div>

										 	<% end %>

										 </div>

									</div>

								</div>

							 <% end %>

						</tbody>
					</div>
				</div>
				<div class="right">

					<table id="allUsers" class="table table-hover">

						<thead>
    						<tr>
     						 <th scope="col">User</th>
     						 <th scope="col">Status</th>
     						</tr>
     					</thead>
						  <% User.all.order(:id).first(10).each do |user| %>
						  	<tr>

							 	<% if current_user == user %>
								<% else %>


									 	<th class="userName"><%= user.name %></th>
									
							 			<td class="friendAction"> 

									 		<%= form_with url: "users/addFriend", method: :get, 
									 			authenticity_token: false do |f|%>
										 		<input id="user1_id" name="user1_id" type="hidden", value="<%= current_user.id %>" />
										 		<input id="user2_id" name="user2_id" type="hidden", value="<%= user.id %>" />

										 		<% if current_user.areWeFriends(user) %>
										 			<div class="actions">
											 			<%= button_tag( :class => "icon-users") do %>
											 			<% end %>
											 		</div>

											 	<% elsif current_user.userRequestedFriendship(user) %>
											 		<div class="actions">
											 			<%= button_tag( :class => "icon-user-check") do %>
											 			<% end %>
											 		</div>

											 	<% elsif current_user.alreadySentRequest(user) %>
											 			<span class="icon-dots-three-horizontal" />
											 	<% else %>

											 		<div class="actions">
											   		<%= button_tag( :class => "icon-user-plus") do %>
											   		<% end %>
											 	  	</div>
										 		<% end %>
							 				<% end %>

						 				</td>

						 			</div>

								<% end %>

						 	</tr>

						  <% end %>

					</table>

				</div>
			</div>
		</div>
	</body>
</html>
